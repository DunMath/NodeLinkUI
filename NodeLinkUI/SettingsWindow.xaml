<Window x:Class="NodeLinkUI.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Settings" Height="660" Width="980"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Text="NodeLink Settings" FontSize="18" FontWeight="Bold" />

        <!-- Body -->
        <Grid Grid.Row="1" Margin="0,10,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Orientation="Vertical">

                    <!-- General -->
                    <GroupBox Header="General" Margin="0,0,0,10">
                        <Grid Margin="8">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="180"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Master IP -->
                            <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Text="Master IP:"/>
                            <TextBox x:Name="MasterIpTextBox" Grid.Row="0" Grid.Column="1" MinWidth="220"/>

                            <!-- Heartbeat -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Margin="0,6,0,0" VerticalAlignment="Center"
                         Text="Heartbeat (ms):"/>
                            <TextBox x:Name="HeartbeatIntervalTextBox" Grid.Row="1" Grid.Column="1" Margin="0,6,0,0" MinWidth="120"/>

                            <!-- Start role dropdown -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Margin="0,6,0,0" VerticalAlignment="Center"
                         Text="Start role:"/>
                            <ComboBox x:Name="StartRoleCombo" Grid.Row="2" Grid.Column="1" Margin="0,6,0,0" Width="180"
                        ToolTip="Role to use on next launch">
                                <ComboBoxItem Content="Master"/>
                                <ComboBoxItem Content="Agent"/>
                            </ComboBox>

                            <!-- Use GPU globally -->
                            <CheckBox x:Name="UseGpuCheckBox" Grid.Row="3" Grid.Column="1" Margin="0,8,0,0"
                        Content="Prefer GPU where available" />
                        </Grid>
                    </GroupBox>

                    <!-- Nominated Apps -->
                    <GroupBox Header="Nominated Apps" Margin="0,0,0,10">
                        <Grid Margin="8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="3*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- App list -->
                            <ListBox x:Name="SelectedAppsListBox"
                       Grid.Row="0" Grid.Column="0" Margin="0,0,8,0"
                       SelectionChanged="SelectedAppsListBox_SelectionChanged"
                       MinHeight="160"/>

                            <!-- Details/edit -->
                            <Grid Grid.Row="0" Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Text="Name:"/>
                                <TextBox x:Name="AppNameTextBox" Grid.Row="0" Grid.Column="1" Margin="0,0,8,0"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Margin="0,6,0,0" VerticalAlignment="Center" Text="Path:"/>
                                <TextBox x:Name="AppPathTextBox" Grid.Row="1" Grid.Column="1" Margin="0,6,8,0"/>
                                <Button Content="Open" Grid.Row="1" Grid.Column="2" Margin="0,6,0,0" Padding="10,4"
                        Click="OpenAppButton_Click"/>

                                <!-- filler -->
                                <Border Grid.Row="2" Grid.ColumnSpan="3" />
                            </Grid>

                            <!-- Buttons -->
                            <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal" Margin="0,8,0,0">
                                <Button x:Name="AddAppButton" Content="Add..." Padding="12,6" Click="AddAppButton_Click"/>
                                <Button x:Name="RemoveAppButton" Content="Remove" Padding="12,6" Margin="8,0,0,0"
                        Click="RemoveAppButton_Click"/>
                            </StackPanel>

                            <TextBlock Grid.Row="2" Grid.ColumnSpan="2" Margin="0,8,0,0" Foreground="Gray"
                         Text="Tip: double-click an item in the list to launch it."/>
                        </Grid>
                    </GroupBox>

                    <!-- Security (Join Code) -->
                    <GroupBox Header="Security (Join Code)" Margin="0,0,0,10">
                        <Grid Margin="8">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="180"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Text="Node Join Code:"/>

                            <!-- masked -->
                            <PasswordBox x:Name="JoinCodeSecret" Grid.Row="0" Grid.Column="1" MinWidth="240"/>
                            <!-- plain (hidden by default; code-behind toggles visibility) -->
                            <TextBox x:Name="JoinCodePlain" Grid.Row="0" Grid.Column="1" MinWidth="240" Visibility="Collapsed"/>

                            <CheckBox x:Name="ShowCodeCheckBox" Grid.Row="0" Grid.Column="2" Margin="8,0,0,0"
                        Content="Show" VerticalAlignment="Center"
                        Checked="ShowCodeCheckBox_Checked"
                        Unchecked="ShowCodeCheckBox_Unchecked"/>

                            <Button x:Name="GenerateJoinCodeButton" Grid.Row="1" Grid.Column="1" Margin="0,8,0,0"
                      Content="Generate" Padding="12,6"
                      HorizontalAlignment="Left"
                      Click="GenerateJoinCodeButton_Click"/>

                            <Button x:Name="CopyJoinCodeButton" Grid.Row="1" Grid.Column="2" Margin="8,8,0,0"
                      Content="Copy" Padding="12,6"
                      Click="CopyJoinCodeButton_Click"/>
                        </Grid>
                    </GroupBox>

                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- Footer buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Cancel" Margin="0,0,8,0" Padding="14,6" Click="CancelButton_Click" IsCancel="True"/>
            <Button Content="Save"   Padding="18,6" Click="SaveButton_Click" IsDefault="True"/>
        </StackPanel>
    </Grid>
</Window>







